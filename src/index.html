<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>StageView</title>
  <link rel="stylesheet" href="style.css" />
</head>
<body>

  <!-- Camera Grid -->
  <div id="grid"></div>

  <!-- Pixel Refresh Overlay (burn-in protection in solo mode) -->
  <div id="pixel-refresh"></div>

  <!-- Empty State -->
  <div id="empty-state">
    <div class="empty-icon">ðŸ“·</div>
    <h2>No cameras configured</h2>
    <p>Open settings to add your first camera feed</p>
    <button id="empty-add-camera">Add Camera</button>
  </div>

  <!-- Toolbar (auto-hides) -->
  <div id="toolbar">
    <span id="shuffle-timer" title="Time until next shuffle"></span>

    <!-- Camera selector -->
    <div class="toolbar-camera-group">
      <button id="camera-menu-btn" title="Camera selector">
        <svg id="camera-menu-icon-grid" class="toolbar-icon" viewBox="0 0 16 16" fill="none">
          <rect x="1" y="1" width="6" height="6" rx="1" stroke="currentColor" stroke-width="1.5"/>
          <rect x="9" y="1" width="6" height="6" rx="1" stroke="currentColor" stroke-width="1.5"/>
          <rect x="1" y="9" width="6" height="6" rx="1" stroke="currentColor" stroke-width="1.5"/>
          <rect x="9" y="9" width="6" height="6" rx="1" stroke="currentColor" stroke-width="1.5"/>
        </svg>
        <svg id="camera-menu-icon-solo" class="toolbar-icon" viewBox="0 0 16 16" fill="none" style="display:none">
          <rect x="1" y="1" width="14" height="14" rx="2" stroke="currentColor" stroke-width="1.5"/>
          <circle cx="8" cy="8" r="2.5" fill="currentColor"/>
        </svg>
        <span id="camera-menu-label"></span>
        <svg class="toolbar-chevron" viewBox="0 0 10 6" fill="none">
          <path d="M1 1L5 5L9 1" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
        </svg>
      </button>
      <div id="camera-menu" class="camera-menu hidden">
        <div class="camera-menu-list">
          <button class="camera-menu-item grid-view-item" id="grid-view-btn">
            <div class="camera-menu-item-icon">
              <svg viewBox="0 0 16 16" fill="none">
                <rect x="1" y="1" width="6" height="6" rx="1" stroke="currentColor" stroke-width="1.5"/>
                <rect x="9" y="1" width="6" height="6" rx="1" stroke="currentColor" stroke-width="1.5"/>
                <rect x="1" y="9" width="6" height="6" rx="1" stroke="currentColor" stroke-width="1.5"/>
                <rect x="9" y="9" width="6" height="6" rx="1" stroke="currentColor" stroke-width="1.5"/>
              </svg>
            </div>
            <span class="camera-menu-item-label">Grid View</span>
            <svg class="camera-menu-check" viewBox="0 0 16 16" fill="none"><path d="M3 8.5L6.5 12L13 4" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/></svg>
          </button>
          <div class="camera-menu-divider"></div>
          <div id="camera-menu-cameras"></div>
        </div>
      </div>
    </div>

    <div class="toolbar-separator"></div>

    <button id="fullscreen-btn" title="Toggle fullscreen">
      <svg class="toolbar-icon" viewBox="0 0 16 16" fill="none">
        <path d="M2 5V3C2 2.44772 2.44772 2 3 2H5" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/>
        <path d="M11 2H13C13.5523 2 14 2.44772 14 3V5" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/>
        <path d="M14 11V13C14 13.5523 13.5523 14 13 14H11" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/>
        <path d="M5 14H3C2.44772 14 2 13.5523 2 13V11" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/>
      </svg>
    </button>
    <button id="settings-btn" title="Settings">
      <svg class="toolbar-icon" viewBox="0 0 24 24" fill="none">
        <path d="M12 15a3 3 0 1 0 0-6 3 3 0 0 0 0 6Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
        <path d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 1 1-2.83 2.83l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-4 0v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 1 1-2.83-2.83l.06-.06A1.65 1.65 0 0 0 4.68 15a1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1 0-4h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 1 1 2.83-2.83l.06.06A1.65 1.65 0 0 0 9 4.68a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 4 0v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 1 1 2.83 2.83l-.06.06A1.65 1.65 0 0 0 19.4 9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 0 4h-.09a1.65 1.65 0 0 0-1.51 1Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
      </svg>
    </button>
  </div>

  <!-- Settings Panel -->
  <div id="settings-overlay" class="hidden"></div>
  <div id="settings" class="hidden">
    <div class="settings-header">
      <h2>Settings</h2>
      <button class="close-btn" id="settings-close-btn">âœ•</button>
    </div>

    <div class="settings-body">
      <!-- Camera List -->
      <section>
        <h3>Cameras</h3>
        <div id="camera-list"></div>
        <button class="add-btn" id="add-camera-btn">+ Add Camera</button>
      </section>

      <!-- Shuffle Interval -->
      <section>
        <h3>Burn-in Protection</h3>
        <label>
          Shuffle interval
          <div class="interval-input">
            <input type="number" id="shuffle-interval-hours" min="0" max="24" value="0" />
            <span>hours</span>
            <input type="number" id="shuffle-interval-minutes" min="0" max="59" value="15" />
            <span>minutes</span>
          </div>
        </label>
        <p class="hint">Cameras swap positions to prevent screen burn-in</p>
      </section>

      <!-- Display -->
      <section>
        <h3>Display</h3>
        <label class="toggle-row">
          <span>Show status indicators</span>
          <input type="checkbox" id="show-status-dots" checked />
        </label>
        <label class="toggle-row">
          <span>Show camera names</span>
          <input type="checkbox" id="show-camera-names" checked />
        </label>
      </section>

      <!-- Network Control -->
      <section>
        <h3>Network Control</h3>
        <label>
          API port
          <div class="interval-input">
            <input type="number" id="api-port" min="1024" max="65535" value="8090" />
          </div>
        </label>
        <p class="hint">HTTP API for Stream Deck / Companion control (requires restart)</p>
        <div class="api-endpoints">
          <p class="hint" style="margin-top:12px;font-family:monospace">
            GET /api/solo/1 â€” solo camera 1<br>
            GET /api/solo/2 â€” solo camera 2<br>
            GET /api/grid â€” return to grid<br>
            GET /api/status â€” list cameras<br>
            GET /api/fullscreen - fullscreen toggle
          </p>
        </div>
      </section>

      <!-- Updates -->
      <section>
        <h3>Updates</h3>
        <div class="update-row">
          <span id="current-version">v1.0.0</span>
          <button class="check-update-btn" id="check-update-btn">Check for Updates</button>
        </div>
      </section>
    </div>

    <div class="settings-footer">
      <button class="save-btn" id="save-settings-btn">Save & Apply</button>
    </div>
  </div>

  <!-- Update Modal -->
  <div id="update-overlay" class="hidden"></div>
  <div id="update-modal" class="hidden">
    <div class="update-modal-header">
      <h2>Update Available</h2>
      <button class="close-btn" id="update-close-btn">âœ•</button>
    </div>
    <div class="update-modal-body">
      <div class="update-version-info">
        <span class="update-version-current" id="update-current-ver"></span>
        <svg class="update-arrow" viewBox="0 0 24 24" fill="none" width="20" height="20">
          <path d="M5 12h14M13 6l6 6-6 6" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
        </svg>
        <span class="update-version-new" id="update-new-ver"></span>
      </div>
      <div class="update-changelog" id="update-changelog"></div>
      <div class="update-progress hidden" id="update-progress">
        <div class="update-progress-bar">
          <div class="update-progress-fill" id="update-progress-fill"></div>
        </div>
        <span class="update-progress-text" id="update-progress-text">Downloading...</span>
      </div>
    </div>
    <div class="update-modal-footer" id="update-footer">
      <button class="update-later-btn" id="update-later-btn">Later</button>
      <button class="update-now-btn" id="update-now-btn">Update Now</button>
    </div>
  </div>

  <!-- Update Modal -->
  <div id="update-overlay" class="hidden"></div>
  <div id="update-modal" class="hidden">
    <div class="update-modal-header">
      <h2>Update Available</h2>
      <button class="close-btn" id="update-close-btn">&#10005;</button>
    </div>
    <div class="update-modal-body">
      <div class="update-version-info">
        <span class="update-version-current" id="update-current-ver">v1.0.0</span>
        <span class="update-arrow">&#10132;</span>
        <span class="update-version-new" id="update-new-ver">v1.1.0</span>
      </div>
      <div class="update-changelog" id="update-changelog"></div>
      <div class="update-progress hidden" id="update-progress">
        <div class="update-progress-bar">
          <div class="update-progress-fill" id="update-progress-fill"></div>
        </div>
        <span class="update-progress-text" id="update-progress-text">Downloading...</span>
      </div>
    </div>
    <div class="update-modal-footer" id="update-footer">
      <button class="update-later-btn" id="update-later-btn">Later</button>
      <button class="update-now-btn" id="update-now-btn">Update Now</button>
    </div>
  </div>

  <script src="main.js"></script>
</body>
</html>
